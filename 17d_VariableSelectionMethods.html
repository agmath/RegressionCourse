<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-08-17">

<title>Variable Selection Methods: Regularization with Ridge and LASSO</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="17d_VariableSelectionMethods_files/libs/clipboard/clipboard.min.js"></script>
<script src="17d_VariableSelectionMethods_files/libs/quarto-html/quarto.js"></script>
<script src="17d_VariableSelectionMethods_files/libs/quarto-html/popper.min.js"></script>
<script src="17d_VariableSelectionMethods_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="17d_VariableSelectionMethods_files/libs/quarto-html/anchor.min.js"></script>
<link href="17d_VariableSelectionMethods_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="17d_VariableSelectionMethods_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="17d_VariableSelectionMethods_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="17d_VariableSelectionMethods_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="17d_VariableSelectionMethods_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="17d_VariableSelectionMethods_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="17d_VariableSelectionMethods_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#recap" id="toc-recap" class="nav-link active" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#ordinary-least-squares" id="toc-ordinary-least-squares" class="nav-link" data-scroll-target="#ordinary-least-squares">Ordinary Least Squares</a></li>
  <li><a href="#ridge-regression" id="toc-ridge-regression" class="nav-link" data-scroll-target="#ridge-regression">Ridge Regression</a></li>
  <li><a href="#least-absolute-shrinkage-and-selection-operator-lasso" id="toc-least-absolute-shrinkage-and-selection-operator-lasso" class="nav-link" data-scroll-target="#least-absolute-shrinkage-and-selection-operator-lasso">Least Absolute Shrinkage and Selection Operator (LASSO)</a>
  <ul class="collapse">
  <li><a href="#some-feature-preprocessing-concerns" id="toc-some-feature-preprocessing-concerns" class="nav-link" data-scroll-target="#some-feature-preprocessing-concerns">Some Feature PreProcessing Concerns</a></li>
  <li><a href="#fitting-a-model-using-ridge-regression-or-the-lasso" id="toc-fitting-a-model-using-ridge-regression-or-the-lasso" class="nav-link" data-scroll-target="#fitting-a-model-using-ridge-regression-or-the-lasso">Fitting a Model Using Ridge Regression or the LASSO</a></li>
  <li><a href="#ummmgreat-so-what-do-i-use-and-when-do-i-use-it" id="toc-ummmgreat-so-what-do-i-use-and-when-do-i-use-it" class="nav-link" data-scroll-target="#ummmgreat-so-what-do-i-use-and-when-do-i-use-it">Ummm…Great – So What Do I Use and When Do I Use It?</a></li>
  </ul></li>
  <li><a href="#implementing-ridge-regression-and-the-lasso" id="toc-implementing-ridge-regression-and-the-lasso" class="nav-link" data-scroll-target="#implementing-ridge-regression-and-the-lasso">Implementing Ridge Regression and the LASSO</a>
  <ul class="collapse">
  <li><a href="#implementing-ridge-regression" id="toc-implementing-ridge-regression" class="nav-link" data-scroll-target="#implementing-ridge-regression">Implementing Ridge Regression</a></li>
  <li><a href="#implementing-the-lasso" id="toc-implementing-the-lasso" class="nav-link" data-scroll-target="#implementing-the-lasso">Implementing the LASSO</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="17d_VariableSelectionMethods.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Variable Selection Methods: Regularization with Ridge and LASSO</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<p>With Cross-Validation, we’ve supercharged our modeling powers. We’ve made our model performance estimates much more reliable, which gives us greater confidence in understanding the predictive power (or lack-thereof) in our models. We’ve become much more responsible modelers, in this sense. We’ll see again soon that cross-validation can actually do much more for us than just provide more reliable performance estimates than the validation-set approach did. For now though, we shift focus slightly to the question – <em>how do we know which predictors should be included in our model</em>?</p>
</section>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>When we first introduced multiple linear regression, we took an approach in which we built a “large” model – a model that included most/all of our available predictors. Once we had that model, we used a procedure called <em>backward elimination</em> to eliminate terms from our model if they were associated with <span class="math inline">\(p\)</span>-values above the 5% significance threshold. We could have taken the opposite approach, starting with an empty model, adding predictors/terms one at a time – a process called <em>forward selection</em>.</p>
<p>With both of these methods, we’re allowing our model to be quite greedy. It may be helpful to think of these processes as allowing our model to go “shopping” for predictors – in the <em>backward selection</em> paradigm, the model begins by adding every item in the store to its shopping cart, and then carefully places the ones it doesn’t want back on the shelves – in the <em>forward selection</em> paradigm, the model begins with an empty cart and adds its favorite items one-by-one into its shopping cart. This seems quite reasonable at first, but we’re engaging in quite risky behavior.</p>
<ul>
<li>From a purely statistical standpoint, we’re evaluating lots of <span class="math inline">\(t\)</span>-tests in determining whether model terms are statistically significant or not. The likelihood of making at least one Type I Error (saying that a model term is statistically significant, when it is not so in the population) becomes very large in these processes.</li>
<li>From a model-fit perspective, the more predictor variables a model has, the more flexible it is – the more flexible a model is, the better it will fit the <em>training data</em> and the more likely it is to become overfit.</li>
</ul>
<p>By allowing our model to “shop” freely for its predictors, we are enticing our model to overfit the training data – giving our model a “budget” to spend on its shopping trip would be a really nice way to lower the likelihood that our model “buys” too many predictors and overfits the training data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optimization Procedures for Model Fitting
</div>
</div>
<div class="callout-body-container callout-body">
<p>All of the models we’ve fit so far in our course use <em>Ordinary Least Squares</em> as the underlying fitting procedure – we are moving to new waters now. Ridge Regression and LASSO models belong to a class of model called <em>Generalized Linear Models</em>, although their fitting procedures under the hood will be different, the consistency of the <code>{tidymodels}</code> framework allows us to make this change quite simply.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regularization
</div>
</div>
<div class="callout-body-container callout-body">
<p>The process of applying an additional constraint such as a <em>budget</em> one example of model constraints commonly referred to as <em>regularization</em>. Regularization techniques are utilized with lots of model classes to help prevent those models from overfitting our training data.</p>
</div>
</div>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<p>After working through this notebook you should be able to:</p>
<ul>
<li>Articulate the <em>backward selection</em> approach and how it relates to the multiple linear regression models we’ve constructed and analyzed so far in our course.</li>
<li>Discuss <em>forward selection</em> as an alternative to the backward selection process.</li>
<li>Discuss and implement <em>Ridge Regression</em> and the <em>LASSO</em> as alternatives to Ordinary Least Squares within the <code>{tidymodels}</code> framework.</li>
<li>Discuss the benefits and drawbacks for forward- and backward-selection, Ridge Regression, and the LASSO relative to one another.</li>
</ul>
<hr>
</section>
<section id="ordinary-least-squares" class="level2">
<h2 class="anchored" data-anchor-id="ordinary-least-squares">Ordinary Least Squares</h2>
<p>The process of fitting a model using ordinary least squares is an <em>optimization</em> problem. Simply put, to fit a model of the form</p>
<p><span class="math display">\[\mathbb{E}\left[y\right] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k\]</span> we minimize the residual sum of squares:</p>
<p><span class="math display">\[\text{Minimize:}~~\sum_{\text{training data}}{\left(y_{\text{observed}} - y_{\text{predicted}}\right)^2}\]</span></p>
<p>Which is equivalent to</p>
<p><span class="math display">\[\text{Minimize:}~\sum_{\text{training data}}{\left(y_{\text{observed}} - \left(\beta_0 + \sum_{i = 1}^{k}{\beta_i x_i}\right)\right)^2}\]</span></p>
<p>This process of choosing values for <span class="math inline">\(\beta_0,~\beta_1,~\beta_2,~\cdots,~\beta_k\)</span> is called <em>Ordinary Least Squares</em> (OLS), and it’s what we’ve been using (or, rather R has been using) all semester long to fit our models.</p>
<p>In OLS, the optimization procedure can freely choose those <span class="math inline">\(\beta\)</span> values, without any constraint (OLS is shopping without a budget). Ridge Regression and the LASSO introduce extra constraints on this optimization problem.</p>
</section>
<section id="ridge-regression" class="level2">
<h2 class="anchored" data-anchor-id="ridge-regression">Ridge Regression</h2>
<p>The process of fitting a model using Ridge Regression is similar to that of using OLS, except that a constraint on the chosen <span class="math inline">\(\beta\)</span> coefficients is imposed. That is, using Ridge Regression to fit a model of the form <span class="math display">\[\mathbb{E}\left[y\right] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k\]</span> Solves the following optimization problem:</p>
<p><span class="math display">\[\begin{array}{ll}\text{Minimize:} &amp; \displaystyle{\sum_{\text{training data}}{\left(y_{\text{observed}} - \left(\beta_0 + \sum_{i = 1}^{k}{\beta_i x_i}\right)\right)^2}}\\
\text{Subject To:} &amp; \displaystyle{\sum_{i=1}^{k}{\beta_i^2} \leq C}\end{array}\]</span></p>
<p>Where <span class="math inline">\(C\)</span> can be thought of as a total coefficient budget. That is, it becomes very expensive for the model to assign lots of non-zero coefficients.</p>
</section>
<section id="least-absolute-shrinkage-and-selection-operator-lasso" class="level2">
<h2 class="anchored" data-anchor-id="least-absolute-shrinkage-and-selection-operator-lasso">Least Absolute Shrinkage and Selection Operator (LASSO)</h2>
<p>The difference between Ridge Regression and the LASSO is in how “spent budget” is calculated. Instead of summing the squares of the <span class="math inline">\(\beta\)</span> coefficients, we’ll sum their absolute values. That is, using LASSO to fit a model of the form <span class="math display">\[\mathbb{E}\left[y\right] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k\]</span> Solves the following optimization problem: <span class="math display">\[\begin{array}{ll}\text{Minimize:} &amp; \displaystyle{\sum_{\text{training data}}{\left(y_{\text{observed}} - \left(\beta_0 + \sum_{i = 1}^{k}{\beta_i x_i}\right)\right)^2}}\\
\text{Subject To:} &amp; \displaystyle{\sum_{i=1}^{k}{\left|\beta_i\right|} \leq C}\end{array}\]</span></p>
<p>Where <span class="math inline">\(C\)</span> can again be thought of as a total coefficient budget. Because it squares the <span class="math inline">\(\beta\)</span> coefficients in the calculation of “budget used”. Furthermore, due to the mathematics behind these algorithms, models fit using the LASSO result in small coefficients being sent to <span class="math inline">\(0\)</span>. That is, the LASSO can be used as a <em>variable selection procedure</em>. Models fit with Ridge Regression often leave several predictors having very small coefficients so, while they don’t have much influence in the overall model predictions, they do still remain in the model.</p>
<section id="some-feature-preprocessing-concerns" class="level3">
<h3 class="anchored" data-anchor-id="some-feature-preprocessing-concerns">Some Feature PreProcessing Concerns</h3>
<p>If we are going to utilize Ridge Regression or the LASSO, we need to ensure that all of our predictors are on a standardized scale. Otherwise, predictors/features whose observed values are large are superficially <em>cheaper</em> for the model to use (because we can attach small coefficients to them) than features whose observed values are already small. Similarly, features whose observed values are very small are artificially made <em>more expensive</em> for the model to use because they demand larger coefficients in order to have influence over model predictions. There are two very common scaling methods:</p>
<ul>
<li><p>Min/Max scaling projects a variable onto the interval <span class="math inline">\(\left[0, 1\right]\)</span>, where the minimum observed value is sent to <span class="math inline">\(0\)</span> and the maximum observed value is sent to <span class="math inline">\(1\)</span>.</p>
<ul>
<li>Min/Max scaling for the variable <span class="math inline">\(x\)</span> is done using the formula: <span class="math inline">\(\displaystyle{\frac{x - \min\left(x\right)}{\max\left(x\right) - \min\left(x\right)}}\)</span>.</li>
<li>We can add <code>step_range()</code> to a <code>recipe()</code> to min/max scale a feature.</li>
</ul></li>
<li><p>Standardization converts a variables raw measurements into standard deviations (<span class="math inline">\(z\)</span>-scores), where the mean of the transformed variable is <span class="math inline">\(0\)</span> and the standard deviation of the transformed variable is <span class="math inline">\(1\)</span>.</p>
<ul>
<li>Standardized scaling for the variable <span class="math inline">\(x\)</span> is done using the formula: <span class="math inline">\(\displaystyle{\frac{x - \text{mean}\left(x\right)}{\text{sd}(x)}}\)</span></li>
<li>We can add <code>step_normalize()</code> to a <code>recipe()</code> to standardize the values of a feature.</li>
</ul></li>
</ul>
</section>
<section id="fitting-a-model-using-ridge-regression-or-the-lasso" class="level3">
<h3 class="anchored" data-anchor-id="fitting-a-model-using-ridge-regression-or-the-lasso">Fitting a Model Using Ridge Regression or the LASSO</h3>
<p>The <code>tidymodels</code> framework provides us with a standardized structure for defining and fitting models. Everything we’ve learned about the syntax and workflow for fitting a linear regression model using OLS can be used to fit these Generalized Linear Models. We’ll just need to <code>set_engine()</code> to something other than <code>"lm"</code> – specifically, an engine which can fit models using the constraints defined in the Ridge Regression and LASSO sections above. We’ll use <code>"glmnet"</code>, which requires two additional arguments <code>mixture</code> and <code>penalty</code>.</p>
<ul>
<li>The <code>mixture</code> argument is a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. Setting <code>mixture = 1</code> results in a LASSO model, while setting <code>mixture = 0</code> results in a Ridge Regression model. Values in between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> result in a <em>mixed</em> LASSO/Ridge approach, where the penalty is partially determined by the Ridge Regression constraint and partially by the LASSO constraint.</li>
<li>The <code>penalty</code> argument corresponds to the amount of <em>regularization</em> being applied – that is, the <code>penalty</code> is related to the <em>budget</em> parameter we’ve described earlier.</li>
</ul>
</section>
<section id="ummmgreat-so-what-do-i-use-and-when-do-i-use-it" class="level3">
<h3 class="anchored" data-anchor-id="ummmgreat-so-what-do-i-use-and-when-do-i-use-it">Ummm…Great – So What Do I Use and When Do I Use It?</h3>
<p>There is some really good news coming – just bear with me!</p>
<p>The choice between Ridge Regression and LASSO depends on your goals. If you are looking for a tool to help with <em>variable selection</em>, then the LASSO is your choice, since it will result in less valuable predictors being assigned coefficients of exactly <span class="math inline">\(0\)</span>. If you are building a predictive model, you might try both and see which one performs better for your specific use-case.</p>
<p>How do I choose a <code>penalty</code>? As I understand it, there’s no great science to choosing a penalty. People will typically try values and see what the best ones are for their particular use-case.</p>
<p>So basically I’ve told you about these two new classes of model that help prevent overfitting. They each require a <code>penalty</code> parameter and I’ve given you no real guidance on how to choose it. For now, we’ll simply choose a <code>penalty</code> parameter and mention what we could build several models with different <code>penalty</code> values to try and find one that performs best. I’ll give you a much better method when we talk about hyperparameter tuning.</p>
</section>
</section>
<section id="implementing-ridge-regression-and-the-lasso" class="level2">
<h2 class="anchored" data-anchor-id="implementing-ridge-regression-and-the-lasso">Implementing Ridge Regression and the LASSO</h2>
<p>There are a few additional concerns with fitting Ridge Regression and LASSO models that we haven’t needed to deal with prior.</p>
<ul>
<li><p>The <code>glmnet</code> engine requires that no missing values are included in any fold.</p>
<ul>
<li>We can <em>omit</em> rows with missing data. (drawback: we are throwing away observations and we may be drastically reducing the size of our available data)</li>
<li>We can <em>omit</em> features with missing data. (drawback: we are sacrificing potentially valuable predictors by omitting them from our model)</li>
<li>We can <em>impute</em> missing values using a <code>step_impute_*()</code> feature engineering step in our recipe. (drawback: we are making our best guess at what the missing value should be, but we are introducing additional uncertainty to our model)</li>
</ul></li>
<li><p>Because the <code>penalty</code> parameter imposes a <em>budget</em> on coefficients, all of our predictors must be on the same scale – otherwise, some predictors are artificially <em>cheaper</em> or <em>more expensive</em> than others to include in our model.</p>
<ul>
<li>We can use <code>step_range()</code> or <code>step_normalize()</code> on <code>all_numerical_predictors()</code> to achieve this.</li>
</ul></li>
</ul>
<p>We’ll filter out the observations with an unknown response (<code>Sale_Price</code>), and we’ll use <code>step_impute_knn()</code> to use a <span class="math inline">\(k\)</span>-nearest neighbors imputation scheme for any missing values in our predictor columns. Finally, we’ll use <code>step_normalize()</code> to center and scale our numerical predictors. Then we’ll proceed as usual.</p>
<section id="implementing-ridge-regression" class="level3">
<h3 class="anchored" data-anchor-id="implementing-ridge-regression">Implementing Ridge Regression</h3>
<p>We’ll build and assess a Ridge Regression model first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ames_known_price <span class="ot">&lt;-</span> ames <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">is.na</span>(Sale_Price)))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames_known_price, <span class="at">prop =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>ames_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>ames_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train, <span class="at">v =</span> <span class="dv">5</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>ridge_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mixture =</span> <span class="dv">0</span>, <span class="at">penalty =</span> <span class="fl">1e4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>reg_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_knn</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_other</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>ridge_reg_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">add_model</span>(ridge_reg_spec) <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">add_recipe</span>(reg_rec)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>ridge_reg_cv <span class="ot">&lt;-</span> ridge_reg_wf <span class="sc">%&gt;%</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(ames_folds)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>ridge_reg_cv <span class="sc">%&gt;%</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">31500.135966</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3295.091381</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.848782</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.020622</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ridge_reg_cv <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>(<span class="at">summarize =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fold1</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">40380.8832905</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold1</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8113437</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold2</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">32296.5525647</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold2</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8502330</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold3</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">23650.9651714</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold3</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8972481</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold4</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">36684.1034145</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold4</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7941962</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold5</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">24488.1753889</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold5</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8908891</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ridge_reg_fit <span class="ot">&lt;-</span> ridge_reg_wf <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(ames_train)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ridge_reg_fit <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">188791.70984</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lot_Frontage</td>
<td style="text-align: right;">796.31887</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lot_Area</td>
<td style="text-align: right;">2636.36801</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year_Built</td>
<td style="text-align: right;">3063.69378</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year_Remod_Add</td>
<td style="text-align: right;">4628.39736</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mas_Vnr_Area</td>
<td style="text-align: right;">4480.80370</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_SF_1</td>
<td style="text-align: right;">-539.71337</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BsmtFin_SF_2</td>
<td style="text-align: right;">791.80008</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Unf_SF</td>
<td style="text-align: right;">-1879.28956</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total_Bsmt_SF</td>
<td style="text-align: right;">5911.99989</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">First_Flr_SF</td>
<td style="text-align: right;">7305.49061</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Second_Flr_SF</td>
<td style="text-align: right;">8181.67116</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Low_Qual_Fin_SF</td>
<td style="text-align: right;">-524.69494</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gr_Liv_Area</td>
<td style="text-align: right;">12300.92624</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Full_Bath</td>
<td style="text-align: right;">2874.76949</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Half_Bath</td>
<td style="text-align: right;">-658.83986</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Full_Bath</td>
<td style="text-align: right;">4221.38633</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Half_Bath</td>
<td style="text-align: right;">2233.83038</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bedroom_AbvGr</td>
<td style="text-align: right;">-889.11549</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kitchen_AbvGr</td>
<td style="text-align: right;">-2422.88820</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TotRms_AbvGrd</td>
<td style="text-align: right;">3417.43895</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fireplaces</td>
<td style="text-align: right;">4536.95443</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Cars</td>
<td style="text-align: right;">5041.60150</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Area</td>
<td style="text-align: right;">2824.62363</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wood_Deck_SF</td>
<td style="text-align: right;">1555.87237</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Open_Porch_SF</td>
<td style="text-align: right;">-284.75723</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Enclosed_Porch</td>
<td style="text-align: right;">1226.81360</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Three_season_porch</td>
<td style="text-align: right;">486.32894</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Screen_Porch</td>
<td style="text-align: right;">3534.36652</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pool_Area</td>
<td style="text-align: right;">-1040.13291</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misc_Val</td>
<td style="text-align: right;">-4752.01219</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mo_Sold</td>
<td style="text-align: right;">-405.39528</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year_Sold</td>
<td style="text-align: right;">-1199.00037</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Longitude</td>
<td style="text-align: right;">769.72448</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Latitude</td>
<td style="text-align: right;">4390.84512</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">MS_SubClass_One_Story_1945_and_Older</td>
<td style="text-align: right;">-4832.96721</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MS_SubClass_One_Story_1946_and_Newer_All_Styles</td>
<td style="text-align: right;">3202.29338</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">MS_SubClass_One_Story_PUD_1946_and_Newer</td>
<td style="text-align: right;">-3648.19533</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MS_SubClass_Two_Story_1946_and_Newer</td>
<td style="text-align: right;">665.56838</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">MS_SubClass_other</td>
<td style="text-align: right;">287.65821</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MS_Zoning_Residential_Medium_Density</td>
<td style="text-align: right;">-5645.17735</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">MS_Zoning_other</td>
<td style="text-align: right;">-6902.63199</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Street_other</td>
<td style="text-align: right;">-23356.12546</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alley_other</td>
<td style="text-align: right;">-110.60832</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lot_Shape_Slightly_Irregular</td>
<td style="text-align: right;">2411.21852</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lot_Shape_other</td>
<td style="text-align: right;">1953.92542</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Land_Contour_other</td>
<td style="text-align: right;">136.73405</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Utilities_other</td>
<td style="text-align: right;">-15838.48097</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lot_Config_CulDSac</td>
<td style="text-align: right;">10227.06658</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lot_Config_Inside</td>
<td style="text-align: right;">238.57320</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lot_Config_other</td>
<td style="text-align: right;">-5644.27896</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Land_Slope_other</td>
<td style="text-align: right;">4960.68588</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neighborhood_Edwards</td>
<td style="text-align: right;">-8912.65959</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neighborhood_Gilbert</td>
<td style="text-align: right;">-15851.15782</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neighborhood_North_Ames</td>
<td style="text-align: right;">-4943.77431</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neighborhood_Northridge_Heights</td>
<td style="text-align: right;">18963.37114</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neighborhood_Old_Town</td>
<td style="text-align: right;">-6176.63079</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neighborhood_Somerset</td>
<td style="text-align: right;">8825.83248</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neighborhood_other</td>
<td style="text-align: right;">4868.82978</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition_1_Norm</td>
<td style="text-align: right;">9690.18424</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Condition_1_other</td>
<td style="text-align: right;">1658.63595</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Condition_2_other</td>
<td style="text-align: right;">121.73332</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bldg_Type_TwnhsE</td>
<td style="text-align: right;">-10559.04514</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bldg_Type_other</td>
<td style="text-align: right;">-11382.12086</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">House_Style_One_Story</td>
<td style="text-align: right;">2307.09727</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">House_Style_Two_Story</td>
<td style="text-align: right;">-2111.32137</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">House_Style_other</td>
<td style="text-align: right;">-877.41700</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall_Qual_Average</td>
<td style="text-align: right;">-1984.73829</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall_Qual_Below_Average</td>
<td style="text-align: right;">-3299.97991</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall_Qual_Good</td>
<td style="text-align: right;">1126.18427</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall_Qual_Very_Good</td>
<td style="text-align: right;">14813.63526</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall_Qual_other</td>
<td style="text-align: right;">29424.63035</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall_Cond_Average</td>
<td style="text-align: right;">-2036.76744</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall_Cond_Good</td>
<td style="text-align: right;">4967.76736</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall_Cond_other</td>
<td style="text-align: right;">-3677.52163</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Roof_Style_Hip</td>
<td style="text-align: right;">5321.81005</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Roof_Style_other</td>
<td style="text-align: right;">-4334.05469</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Roof_Matl_other</td>
<td style="text-align: right;">2536.26513</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exterior_1st_MetalSd</td>
<td style="text-align: right;">1789.15098</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exterior_1st_Plywood</td>
<td style="text-align: right;">245.73682</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exterior_1st_VinylSd</td>
<td style="text-align: right;">763.44060</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exterior_1st_Wd.Sdng</td>
<td style="text-align: right;">39.68877</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exterior_1st_other</td>
<td style="text-align: right;">6045.78572</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exterior_2nd_MetalSd</td>
<td style="text-align: right;">1876.79559</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exterior_2nd_Plywood</td>
<td style="text-align: right;">-3296.46398</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exterior_2nd_VinylSd</td>
<td style="text-align: right;">924.71122</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exterior_2nd_Wd.Sdng</td>
<td style="text-align: right;">3394.08267</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exterior_2nd_other</td>
<td style="text-align: right;">-407.40383</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mas_Vnr_Type_None</td>
<td style="text-align: right;">5526.82124</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mas_Vnr_Type_Stone</td>
<td style="text-align: right;">3042.59449</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mas_Vnr_Type_other</td>
<td style="text-align: right;">-9062.56602</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exter_Qual_Typical</td>
<td style="text-align: right;">-6768.82107</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exter_Qual_other</td>
<td style="text-align: right;">16684.08382</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exter_Cond_Typical</td>
<td style="text-align: right;">-742.10084</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exter_Cond_other</td>
<td style="text-align: right;">-14408.92915</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Foundation_CBlock</td>
<td style="text-align: right;">-2418.14587</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Foundation_PConc</td>
<td style="text-align: right;">4372.23813</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Foundation_other</td>
<td style="text-align: right;">269.13186</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Qual_Good</td>
<td style="text-align: right;">-12590.03081</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Qual_Typical</td>
<td style="text-align: right;">-11360.01363</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Qual_other</td>
<td style="text-align: right;">-11250.01642</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Cond_other</td>
<td style="text-align: right;">-2698.01896</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Exposure_Gd</td>
<td style="text-align: right;">14083.73631</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Exposure_Mn</td>
<td style="text-align: right;">-4822.50510</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bsmt_Exposure_No</td>
<td style="text-align: right;">-8071.95550</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Exposure_other</td>
<td style="text-align: right;">-5347.16020</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_Type_1_BLQ</td>
<td style="text-align: right;">-804.11423</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BsmtFin_Type_1_GLQ</td>
<td style="text-align: right;">7399.35027</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_Type_1_LwQ</td>
<td style="text-align: right;">-4119.78777</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BsmtFin_Type_1_Rec</td>
<td style="text-align: right;">-790.39767</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_Type_1_Unf</td>
<td style="text-align: right;">-2218.54216</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">BsmtFin_Type_1_other</td>
<td style="text-align: right;">-3351.91538</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_Type_2_other</td>
<td style="text-align: right;">-1889.50312</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Heating_other</td>
<td style="text-align: right;">-1479.67159</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heating_QC_Good</td>
<td style="text-align: right;">-2440.28159</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Heating_QC_Typical</td>
<td style="text-align: right;">-5255.01167</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heating_QC_other</td>
<td style="text-align: right;">-10308.11682</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Central_Air_Y</td>
<td style="text-align: right;">4646.75279</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Electrical_SBrkr</td>
<td style="text-align: right;">318.95670</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Electrical_other</td>
<td style="text-align: right;">-146.28148</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kitchen_Qual_Good</td>
<td style="text-align: right;">-10595.62477</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kitchen_Qual_Typical</td>
<td style="text-align: right;">-13183.23141</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kitchen_Qual_other</td>
<td style="text-align: right;">-15338.12342</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Functional_other</td>
<td style="text-align: right;">-15019.47361</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fireplace_Qu_No_Fireplace</td>
<td style="text-align: right;">-947.63813</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fireplace_Qu_Typical</td>
<td style="text-align: right;">-2047.88316</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fireplace_Qu_other</td>
<td style="text-align: right;">544.63828</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Type_BuiltIn</td>
<td style="text-align: right;">592.47646</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Type_Detchd</td>
<td style="text-align: right;">-1803.54659</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Type_No_Garage</td>
<td style="text-align: right;">212.40839</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Type_other</td>
<td style="text-align: right;">-11813.03977</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Finish_No_Garage</td>
<td style="text-align: right;">378.46275</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Finish_RFn</td>
<td style="text-align: right;">-4021.15008</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Finish_Unf</td>
<td style="text-align: right;">-1988.47596</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Qual_Typical</td>
<td style="text-align: right;">-1342.56651</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Qual_other</td>
<td style="text-align: right;">2158.84972</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Cond_Typical</td>
<td style="text-align: right;">2395.30760</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Cond_other</td>
<td style="text-align: right;">-6099.84155</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paved_Drive_Paved</td>
<td style="text-align: right;">4144.04509</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paved_Drive_other</td>
<td style="text-align: right;">5128.66923</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pool_QC_other</td>
<td style="text-align: right;">8473.62349</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fence_No_Fence</td>
<td style="text-align: right;">-1923.52356</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fence_other</td>
<td style="text-align: right;">-832.59507</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misc_Feature_other</td>
<td style="text-align: right;">5427.83293</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sale_Type_WD</td>
<td style="text-align: right;">-4415.50041</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sale_Type_other</td>
<td style="text-align: right;">-6892.17869</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sale_Condition_Normal</td>
<td style="text-align: right;">6815.41569</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sale_Condition_Partial</td>
<td style="text-align: right;">11236.53847</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sale_Condition_other</td>
<td style="text-align: right;">5741.78860</td>
<td style="text-align: right;">10000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>From the regression output above, we can see some predictors getting large coefficients, while others recieve coefficients on a smaller scale.</p>
</section>
<section id="implementing-the-lasso" class="level3">
<h3 class="anchored" data-anchor-id="implementing-the-lasso">Implementing the LASSO</h3>
<p>The work required to construct a LASSO model is nearly identical. We simply use <code>mixture = 1</code> in the model specification to signal that we want to use the LASSO constraint instead of the ridge constraint.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lasso_reg_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fl">1e4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>lasso_reg_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">add_model</span>(lasso_reg_spec) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">add_recipe</span>(reg_rec)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>lasso_reg_cv <span class="ot">&lt;-</span> lasso_reg_wf <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(ames_folds)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>lasso_reg_cv <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std_err</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">39400.740143</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3246.8426135</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.797465</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0229212</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>lasso_reg_cv <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>(<span class="at">summarize =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.metric</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.estimator</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.estimate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">.config</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fold1</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">48609.2138434</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold1</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7762703</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold2</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">42312.8702790</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold2</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7742343</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold3</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">31940.0083101</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold3</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8491859</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold4</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">42122.7110247</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold4</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.7354344</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fold5</td>
<td style="text-align: left;">rmse</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">32018.8972595</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fold5</td>
<td style="text-align: left;">rsq</td>
<td style="text-align: left;">standard</td>
<td style="text-align: right;">0.8522000</td>
<td style="text-align: left;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lasso_reg_fit <span class="ot">&lt;-</span> lasso_reg_wf <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(ames_train)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>lasso_reg_fit <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">penalty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">184321.933009</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year_Built</td>
<td style="text-align: right;">7211.041919</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Year_Remod_Add</td>
<td style="text-align: right;">4892.535342</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mas_Vnr_Area</td>
<td style="text-align: right;">2528.604376</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total_Bsmt_SF</td>
<td style="text-align: right;">11760.066322</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gr_Liv_Area</td>
<td style="text-align: right;">25031.362051</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fireplaces</td>
<td style="text-align: right;">3468.087043</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Garage_Cars</td>
<td style="text-align: right;">7144.990272</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Garage_Area</td>
<td style="text-align: right;">3629.553856</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neighborhood_Northridge_Heights</td>
<td style="text-align: right;">15138.287188</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Overall_Qual_Very_Good</td>
<td style="text-align: right;">1102.160399</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Overall_Qual_other</td>
<td style="text-align: right;">20288.292906</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exter_Qual_Typical</td>
<td style="text-align: right;">-10032.425048</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bsmt_Exposure_Gd</td>
<td style="text-align: right;">8094.334611</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BsmtFin_Type_1_GLQ</td>
<td style="text-align: right;">5624.878842</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kitchen_Qual_Typical</td>
<td style="text-align: right;">-4541.882839</td>
<td style="text-align: right;">10000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fireplace_Qu_No_Fireplace</td>
<td style="text-align: right;">-4.359246</td>
<td style="text-align: right;">10000</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We can see in the LASSO model that many of the predictors were assigned coefficients of <span class="math inline">\(0\)</span>. The LASSO procedure identified that those predictors weren’t worth “buying”, so it left them out and only included the most useful predictors!</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In this notebook, we introduced two new regression models: <em>Ridge Regression</em> and the <em>LASSO</em>. These models are of the familiar form <span class="math inline">\(\mathbb{E}\left[y\right] = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k\)</span>, but are fit using a <em>constrained</em> optimization procedure rather than <em>ordinary least squares</em>. When we implement Ridge and the LASSO, we are reducing the likelihood that the resulting model is overfit. With these models, however, we must remember that all numerical predictors need to be <em>scaled</em> and no missing data can be present in the training data.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>